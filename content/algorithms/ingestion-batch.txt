ingestBatch(new, store)  {
  newVersion = store.getLastVersion() + 1
  changeset  = new
      .read()
      .sort()
      .encode(store.getDictionary(newVersion))
  lastChangeset   = store.getLastChangeset()
  mergedChangeset = mergeChangesets(lastChangeset, changesetEncoded)
  
  for (triple, localChange : mergedChangeset.getAdditions()) {
    store.addAddition(triple, newVersion, localChange)
  }
  
  for (triple, localChange : mergedChangeset.getDeletions()) {
    positions = calculatePositions(triple)
    store.addDeletion(triple, newVersion, localChange, positions)
  }
}